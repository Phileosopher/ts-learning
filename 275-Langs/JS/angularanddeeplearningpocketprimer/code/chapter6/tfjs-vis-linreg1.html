<html>
  <head>
    <!-- Get latest version at https://github.com/tensorflow/tfjs -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"> 
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@latest"> 
    </script>
 
    <style>
      .plot {
        width: 100%;
        height: 40%;
        margin: 4px;
      }

      .btn { display: float-left; }
    </style>
  </head>

  <body>
    <div id="mydiv"></div>

    <div>
    <button class="btn" type="button" onclick="trainLinearModel()">Train the Model</button>
    </div>
    <!-- the scatterplot is displayed here: -->
    <div class="plot" id="plot1"></div>
  </body>

  <script>
   async function trainLinearModel() {
     //----------------------------------
     // define a simple model that has:
     // 1) a single input (numeric value)
     // 3) connected to the output layer
     // 4) an output layer of one neuron
     //----------------------------------
 
     const model = tf.sequential();
     model.add(tf.layers.dense({units: 1, inputShape: [1]}));
     model.compile({
        loss: 'meanSquaredError',
        optimizer: 'sgd'
     });
     
     var epochs  = 100
     var maxRand = 30
     var count   = 100
     items1 = []
     itemsX = []
     itemsY = []
     values = []

     // define the data points
     for(var i=0; i<count; i++) {
       x = i
       y = 2*x + 1 + Math.random()*maxRand

       items1.push({"x":x, "y":y})
       itemsX.push(x)
       itemsY.push(y)
     } 

     values.push(items1)

     const xs = tf.tensor1d([1,2,3,4,5,6,7,8,9,10]);
     const ys = tf.tensor1d([3,5,7,9,11,13,15,17,19,21]);

     // legend-related information 
     let series1 = ['Dataset1', 'Dataset2']; 

     // render the scatter plot in the 'plot1' element:
     tfvis.render.scatterplot(document.getElementById('plot1'), {values,series1}, {
       width:  600,
       xLabel: 'x-axis',  
       yLabel: 'y-axis'
     })
     
     // train the model: 
     await model.fit(xs, ys, {epochs: epochs});

     // predict the value of y when x = 52.5:
     var mydiv = document.getElementById('mydiv');
     mydiv.innerText+= "Prediction for 52.5: "+model.predict(tf.tensor1d([50]));
   }
  </script>
</html>

